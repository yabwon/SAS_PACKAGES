{"creationTimeStamp":"2025-12-05T20:30:48.870099Z","createdBy":"Stu.Sztukowski@sas.com","modifiedTimeStamp":"2025-12-08T23:41:23.322752Z","modifiedBy":"Stu.Sztukowski@sas.com","name":"Initialize SAS Packages Framework.step","displayName":"Initialize SAS Packages Framework.step","localDisplayName":"Initialize SAS Packages Framework.step","links":[{"method":"GET","rel":"self","href":"/dataFlows/steps/f5c86c1d-4813-4046-8bdc-b6bd4c024fca","uri":"/dataFlows/steps/f5c86c1d-4813-4046-8bdc-b6bd4c024fca","type":"application/vnd.sas.data.flow.step"},{"method":"GET","rel":"alternate","href":"/dataFlows/steps/f5c86c1d-4813-4046-8bdc-b6bd4c024fca","uri":"/dataFlows/steps/f5c86c1d-4813-4046-8bdc-b6bd4c024fca","type":"application/vnd.sas.data.flow.step.summary"},{"method":"GET","rel":"up","href":"/dataFlows/steps","uri":"/dataFlows/steps","type":"application/vnd.sas.collection","itemType":"application/vnd.sas.data.flow.step.summary"},{"method":"PUT","rel":"update","href":"/dataFlows/steps/f5c86c1d-4813-4046-8bdc-b6bd4c024fca","uri":"/dataFlows/steps/f5c86c1d-4813-4046-8bdc-b6bd4c024fca","type":"application/vnd.sas.data.flow.step","responseType":"application/vnd.sas.data.flow.step"},{"method":"DELETE","rel":"delete","href":"/dataFlows/steps/f5c86c1d-4813-4046-8bdc-b6bd4c024fca","uri":"/dataFlows/steps/f5c86c1d-4813-4046-8bdc-b6bd4c024fca"},{"method":"POST","rel":"copy","href":"/dataFlows/steps/f5c86c1d-4813-4046-8bdc-b6bd4c024fca/copy","uri":"/dataFlows/steps/f5c86c1d-4813-4046-8bdc-b6bd4c024fca/copy","responseType":"application/vnd.sas.data.flow.step"},{"method":"GET","rel":"transferExport","href":"/dataFlows/steps/f5c86c1d-4813-4046-8bdc-b6bd4c024fca","uri":"/dataFlows/steps/f5c86c1d-4813-4046-8bdc-b6bd4c024fca","responseType":"application/vnd.sas.transfer.object"},{"method":"PUT","rel":"transferImportUpdate","href":"/dataFlows/steps/f5c86c1d-4813-4046-8bdc-b6bd4c024fca","uri":"/dataFlows/steps/f5c86c1d-4813-4046-8bdc-b6bd4c024fca","type":"application/vnd.sas.transfer.object","responseType":"application/vnd.sas.summary"}],"metadataVersion":1,"version":2,"type":"code","flowMetadata":{},"ui":"{\n\t\"showPageContentOnly\": true,\n\t\"pages\": [\n\t\t{\n\t\t\t\"id\": \"page1\",\n\t\t\t\"type\": \"page\",\n\t\t\t\"label\": \"Main\",\n\t\t\t\"children\": [\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"spf_init_debug\",\n\t\t\t\t\t\"type\": \"checkbox\",\n\t\t\t\t\t\"label\": \"Debug\",\n\t\t\t\t\t\"visible\": \"\"\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"spf_init_type\",\n\t\t\t\t\t\"type\": \"radiogroup\",\n\t\t\t\t\t\"label\": \"Select a location for SPFInit.sas\",\n\t\t\t\t\t\"items\": [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"value\": \"URL\"\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"value\": \"File\"\n\t\t\t\t\t\t}\n\t\t\t\t\t],\n\t\t\t\t\t\"visible\": \"\"\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"spf_init_url\",\n\t\t\t\t\t\"type\": \"textfield\",\n\t\t\t\t\t\"label\": \"\",\n\t\t\t\t\t\"placeholder\": \"Enter a URL for spfinit.sas\",\n\t\t\t\t\t\"required\": true,\n\t\t\t\t\t\"visible\": [\n\t\t\t\t\t\t\"$spf_init_type\",\n\t\t\t\t\t\t\"=\",\n\t\t\t\t\t\t\"URL\"\n\t\t\t\t\t]\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"spf_init_fqp\",\n\t\t\t\t\t\"type\": \"path\",\n\t\t\t\t\t\"label\": \"\",\n\t\t\t\t\t\"pathtype\": \"file\",\n\t\t\t\t\t\"placeholder\": \"Select SPFInit.sas\",\n\t\t\t\t\t\"required\": true,\n\t\t\t\t\t\"visible\": [\n\t\t\t\t\t\t\"$spf_init_type\",\n\t\t\t\t\t\t\"=\",\n\t\t\t\t\t\t\"File\"\n\t\t\t\t\t]\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"spf_package_folder\",\n\t\t\t\t\t\"type\": \"path\",\n\t\t\t\t\t\"label\": \"Select a folder for SAS packages\",\n\t\t\t\t\t\"pathtype\": \"folder\",\n\t\t\t\t\t\"placeholder\": \"\",\n\t\t\t\t\t\"required\": true,\n\t\t\t\t\t\"visible\": \"\"\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"spf_package_install\",\n\t\t\t\t\t\"type\": \"checkbox\",\n\t\t\t\t\t\"label\": \"Install packages\",\n\t\t\t\t\t\"visible\": \"\",\n\t\t\t\t\t\"indent\": 0\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"spf_package_update\",\n\t\t\t\t\t\"type\": \"checkbox\",\n\t\t\t\t\t\"label\": \"Update Packages\",\n\t\t\t\t\t\"visible\": \"$spf_package_install\",\n\t\t\t\t\t\"indent\": 1\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"spf_package_load\",\n\t\t\t\t\t\"type\": \"checkbox\",\n\t\t\t\t\t\"label\": \"Load packages\",\n\t\t\t\t\t\"visible\": \"\"\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"spf_repo\",\n\t\t\t\t\t\"type\": \"radiogroup\",\n\t\t\t\t\t\"label\": \"Package Repository\",\n\t\t\t\t\t\"items\": [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"value\": \"SAS Packages\"\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"value\": \"PharmaForest\"\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"value\": \"GitHub\"\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"value\": \"Custom\"\n\t\t\t\t\t\t}\n\t\t\t\t\t],\n\t\t\t\t\t\"visible\": \"$spf_package_install\"\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"spf_github_name\",\n\t\t\t\t\t\"type\": \"textfield\",\n\t\t\t\t\t\"label\": \"\",\n\t\t\t\t\t\"placeholder\": \"Enter GitHub username or organization\",\n\t\t\t\t\t\"required\": true,\n\t\t\t\t\t\"visible\": [\n\t\t\t\t\t\t\"$spf_repo\",\n\t\t\t\t\t\t\"=\",\n\t\t\t\t\t\t\"GitHub\"\n\t\t\t\t\t]\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"spf_custom_url\",\n\t\t\t\t\t\"type\": \"textfield\",\n\t\t\t\t\t\"label\": \"\",\n\t\t\t\t\t\"placeholder\": \"https://package-location.com/\",\n\t\t\t\t\t\"required\": true,\n\t\t\t\t\t\"visible\": [\n\t\t\t\t\t\t\"$spf_repo\",\n\t\t\t\t\t\t\"=\",\n\t\t\t\t\t\t\"Custom\"\n\t\t\t\t\t]\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"spf_package_list\",\n\t\t\t\t\t\"type\": \"textarea\",\n\t\t\t\t\t\"label\": \"Package list (space or carriage-return separated)\",\n\t\t\t\t\t\"placeholder\": \"\",\n\t\t\t\t\t\"required\": true,\n\t\t\t\t\t\"visible\": [\n\t\t\t\t\t\t\"$spf_package_install\",\n\t\t\t\t\t\t\"|\",\n\t\t\t\t\t\t\"$spf_package_load\"\n\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t]\n\t\t}\n\t],\n\t\"syntaxversion\": \"1.3.0\",\n\t\"values\": {\n\t\t\"spf_init_debug\": true,\n\t\t\"spf_init_type\": {\n\t\t\t\"value\": \"URL\"\n\t\t},\n\t\t\"spf_init_url\": \"https://raw.githubusercontent.com/yabwon/SAS_PACKAGES/refs/heads/main/SPF/SPFinit.sas\",\n\t\t\"spf_init_fqp\": \"\",\n\t\t\"spf_package_folder\": \"\",\n\t\t\"spf_package_install\": false,\n\t\t\"spf_package_update\": true,\n\t\t\"spf_package_load\": false,\n\t\t\"spf_repo\": {\n\t\t\t\"value\": \"SAS Packages\"\n\t\t},\n\t\t\"spf_github_name\": \"\",\n\t\t\"spf_custom_url\": \"\",\n\t\t\"spf_package_list\": \"\"\n\t},\n\t\"promptHierarchies\": []\n}","localUi":"{\"pages\":[{\"children\":[{\"id\":\"spf_init_debug\",\"label\":\"Debug\",\"type\":\"checkbox\",\"visible\":\"\"},{\"id\":\"spf_init_type\",\"items\":[{\"value\":\"URL\"},{\"value\":\"File\"}],\"label\":\"Select a location for SPFInit.sas\",\"type\":\"radiogroup\",\"visible\":\"\"},{\"id\":\"spf_init_url\",\"label\":\"\",\"placeholder\":\"Enter a URL for spfinit.sas\",\"required\":true,\"type\":\"textfield\",\"visible\":[\"$spf_init_type\",\"=\",\"URL\"]},{\"id\":\"spf_init_fqp\",\"label\":\"\",\"pathtype\":\"file\",\"placeholder\":\"Select SPFInit.sas\",\"required\":true,\"type\":\"path\",\"visible\":[\"$spf_init_type\",\"=\",\"File\"]},{\"id\":\"spf_package_folder\",\"label\":\"Select a folder for SAS packages\",\"pathtype\":\"folder\",\"placeholder\":\"\",\"required\":true,\"type\":\"path\",\"visible\":\"\"},{\"id\":\"spf_package_install\",\"indent\":0,\"label\":\"Install packages\",\"type\":\"checkbox\",\"visible\":\"\"},{\"id\":\"spf_package_update\",\"indent\":1,\"label\":\"Update Packages\",\"type\":\"checkbox\",\"visible\":\"$spf_package_install\"},{\"id\":\"spf_package_load\",\"label\":\"Load packages\",\"type\":\"checkbox\",\"visible\":\"\"},{\"id\":\"spf_repo\",\"items\":[{\"value\":\"SAS Packages\"},{\"value\":\"PharmaForest\"},{\"value\":\"GitHub\"},{\"value\":\"Custom\"}],\"label\":\"Package Repository\",\"type\":\"radiogroup\",\"visible\":\"$spf_package_install\"},{\"id\":\"spf_github_name\",\"label\":\"\",\"placeholder\":\"Enter GitHub username or organization\",\"required\":true,\"type\":\"textfield\",\"visible\":[\"$spf_repo\",\"=\",\"GitHub\"]},{\"id\":\"spf_custom_url\",\"label\":\"\",\"placeholder\":\"https://package-location.com/\",\"required\":true,\"type\":\"textfield\",\"visible\":[\"$spf_repo\",\"=\",\"Custom\"]},{\"id\":\"spf_package_list\",\"label\":\"Package list (space or carriage-return separated)\",\"placeholder\":\"\",\"required\":true,\"type\":\"textarea\",\"visible\":[\"$spf_package_install\",\"|\",\"$spf_package_load\"]}],\"id\":\"page1\",\"label\":\"Main\",\"type\":\"page\"}],\"promptHierarchies\":[],\"showPageContentOnly\":true,\"syntaxversion\":\"1.3.0\",\"values\":{\"spf_custom_url\":\"\",\"spf_github_name\":\"\",\"spf_init_debug\":true,\"spf_init_fqp\":\"\",\"spf_init_type\":{\"value\":\"URL\"},\"spf_init_url\":\"https://raw.githubusercontent.com/yabwon/SAS_PACKAGES/refs/heads/main/SPF/SPFinit.sas\",\"spf_package_folder\":\"\",\"spf_package_install\":false,\"spf_package_list\":\"\",\"spf_package_load\":false,\"spf_package_update\":true,\"spf_repo\":{\"value\":\"SAS Packages\"}}}","templates":{"SAS":"%if(&spf_init_debug) %then %do;\r\n    %let spf_init_orig_mlogic = %sysfunc(getoption(mlogic));\r\n    %let spf_init_orig_mprint = %sysfunc(getoption(mprint));\r\n    options mlogic mprint mlogicnest mprintnest;\r\n%end;\r\n\r\n%macro spf_init_step;\r\n    %local spf_init_sascontent \r\n           spf_package_sascontent \r\n           spf_package_path \r\n           spf_init_fqp_clean\r\n           spf_init_file \r\n           spf_init_path\r\n           spf_install_args\r\n           rand\r\n    ;\r\n    \r\n    /* Internal values */\r\n    %let spf_init_sascontent    = %sysevalf(%scan(%upcase(&spf_init_fqp), 1, /) = SASCONTENT:, boolean);\r\n    %let spf_package_sascontent = %sysevalf(%scan(%upcase(&spf_package_folder), 1, /) = SASCONTENT:, boolean);\r\n    %let spf_package_path       = %scan(&spf_package_folder, 2, :); /* Remove sascontent or sasserver from the start */\r\n\r\n    /* Randomize filename statement to init packages framework */\r\n    %let rand = %upcase(%substr(%sysfunc(tranwrd(%sysfunc(uuidgen()),-,%str())), 1, 7));\r\n\r\n    /* Remove case-sensitivity */\r\n    %let spf_init_type = %upcase(&spf_init_type);\r\n\r\n    /******* SPF Package Location *******/\r\n\r\n    /* Change the filename statement for SAS Content or a physical path */\r\n    %if(&spf_package_sascontent) %then %do;\r\n        filename packages filesrvc\r\n            folderpath=\"&spf_package_path\"\r\n        ;\r\n    %end;\r\n        %else %do;\r\n            filename packages \"&spf_package_path\";\r\n        %end;\r\n\r\n    /******* SPF Initialization File Location *******/\r\n\r\n    /* Create a filename statement for either a URL, SAS Content, or a physical path */\r\n    %if(&spf_init_type = URL) %then %do;\r\n        filename _&rand url \"&spf_init_url\";\r\n    %end;\r\n\r\n        %else %if(&spf_init_type = FILE) %then %do;\r\n\r\n            %let spf_init_fqp_clean = %scan(&spf_init_fqp, 2, :);\r\n\r\n            %if(&spf_init_sascontent) %then %do;   \r\n            \r\n                /* Get filename and path:\r\n                   - SPFInit.sas\r\n                   - /location/to/file\r\n                */\r\n\r\n                %let spf_init_file = %scan(&spf_init_fqp, -1, /);\r\n                %let spf_init_path = %substr(&spf_init_fqp_clean, 1, %eval(%length(&spf_init_fqp_clean)-%length(&spf_init_file)-1));\r\n                \r\n                filename _&rand filesrvc\r\n                    folderpath=\"&spf_init_path\"\r\n                    filename=\"&spf_init_file\"\r\n                ;\r\n            %end;\r\n\r\n                /* Otherwise, use the physical path on the filesystem */\r\n                %else %do;\r\n                    filename _&rand \"&spf_init_fqp_clean\"; \r\n                %end;\r\n        %end;\r\n\r\n    /******* Run SPFInit.sas *******/\r\n\r\n    /* Run SPFInit.sas */\r\n    %include _&rand;\r\n\r\n    %if(&syserr LE 6) %then %put NOTE: SAS Packages Framework initialized in &spf_package_path;\r\n        %else %do; \r\n            filename _&rand clear;\r\n            %abort;\r\n        %end;\r\n\r\n    filename _&rand clear;\r\n\r\n    %if(&spf_package_install OR &spf_package_load) %then %do;\r\n        %let spf_repo = %upcase(&spf_repo);\r\n        %let spf_package_list_clean = %sysfunc(translate(%superq(spf_package_list),' ','0D0A'x));\r\n        \r\n        %if(&spf_package_install) %then %do;\r\n            /* Set installPackage options depending on the repo selevted */\r\n            %if(&spf_repo = PHARMAFOREST) %then\r\n                %let spf_install_args = mirror=3\r\n            ;\r\n\r\n            %else %if(&spf_repo = GITHUB) %then\r\n                %let spf_install_args = github=&spf_github_name\r\n            ;\r\n\r\n            %else %if(&spf_repo = CUSTOM) %then %do;\r\n\r\n                /* Add an ending / if the user forgot - requirement for this option */\r\n                %if(%substr(&spf_custom_url, %length(&spf_custom_url), 1) NE %str(/)) %then\r\n                    %let spf_custom_url = &spf_custom_url/\r\n                ;\r\n\r\n                %let spf_install_args = mirror=0;\r\n            %end;\r\n\r\n            /* Default: use  */\r\n            %else %let spf_install_args = mirror=1;\r\n\r\n            %let spf_install_args = &spf_install_args, replace=&spf_package_update;\r\n\r\n            %installPackage(&spf_package_list_clean, &spf_install_args);\r\n        %end;\r\n    %end;\r\n\r\n%mend spf_init_step;\r\n%spf_init_step;\r\n\r\n%if(&spf_init_debug) %then %do;\r\n    options &spf_init_orig_mlogic &spf_init_orig_mprint;\r\n%end;"},"eTag":"W/\"1765237283322752000\""}